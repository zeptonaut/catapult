<!DOCTYPE html>
<!--
Copyright 2016 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="/tracing/core/test_utils.html">
<link rel="import" href="/tracing/model/event_set.html">
<link rel="import" href="/tracing/model/model.html">
<link rel="import" href="/tracing/model/power_series.html">
<link rel="import" href="/tracing/ui/analysis/alert_sub_view.html">
<link rel="import" href="/tracing/ui/analysis/multi_power_sample_sub_view.html">
<link rel="import" href="/tracing/ui/base/tab_view2.html">

<script>
'use strict';

tr.b.unittest.testSuite(function() {
  function createPowerSampleSubView() {
    var model = new tr.Model();
    var series = new tr.model.PowerSeries(model.device);

    model.device.vSyncTimestamps = [0];
    series.addPowerSample(1, 1);
    series.addPowerSample(2, 2);
    series.addPowerSample(3, 3);
    series.addPowerSample(4, 2);

    var subView = document.createElement('tr-ui-a-multi-power-sample-sub-view');
    subView.selection = new tr.model.EventSet(series.samples);
    subView.tabLabel = 'Power samples';
    return subView;
  }

  function createAlertSubView() {
    var slice = tr.c.TestUtils.newSliceEx({title: 'b', start: 0, duration: 0.002});
    var alertInfo = new tr.model.EventInfo(
        'Alert 1', 'Critical alert',
        [{
          label: 'Example',
          textContent: 'Example page',
          href: 'http://www.example.com'
        }]);

    var alert = new tr.model.Alert(alertInfo, 5, [slice]);
    var subView = document.createElement('tr-ui-a-alert-sub-view');
    subView.selection = new tr.model.EventSet(alert);
    subView.tabLabel = 'Alerts';

    return subView;
  }

  test('instantiate_noTabs', function() {
    var tabView = document.createElement('tr-ui-a-tab-view2');
    tabView.label = 'No items selected.';
    this.addHTMLOutput(tabView);
  });

  test('instantiate_oneTab', function() {
    var tabView = document.createElement('tr-ui-a-tab-view2');
    tabView.label = '1 item selected.';
    Polymer.dom(tabView).appendChild(createPowerSampleSubView());
    this.addHTMLOutput(tabView);
  });

  test('instantiate_twoTabs', function() {
    var tabView = document.createElement('tr-ui-a-tab-view2');
    tabView.label = '3 items selected.';
    Polymer.dom(tabView).appendChild(createPowerSampleSubView());
    Polymer.dom(tabView).appendChild(createAlertSubView());
    this.addHTMLOutput(tabView);
  });
});
</script>
